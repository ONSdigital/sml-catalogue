---
platform: linux

image_resource:
  type: registry-image
  source:
    repository: public.ecr.aws/ons-spp/python-selenium
    tag: 4

inputs:
  - name: repo
outputs:
  - name: repo

run:
  path: sh
  dir: repo
  args:
    - -exc
    - |
      apt-get -y update && apt-get install -y zip
      apt-get -y update && apt-get install -y libffi-dev
      cd /opt
      wget https://www.python.org/ftp/python/3.10.11/Python-3.10.11.tgz
      tar xzvf Python-3.10.11.tgz
      cd Python-3.10.11
      ./configure
      make
      make install
      sudo ln -fs /opt/Python-3.10.11/Python /usr/bin/python3.10
      cd /repo
      bash ./ci/tasks/build_and_deploy/build_files.sh
